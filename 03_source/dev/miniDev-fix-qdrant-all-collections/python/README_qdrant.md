# üîß Qdrant Manager - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –∫–æ–ª–ª–µ–∫—Ü–∏–π –≤ Qdrant —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –º–∞—Å—Å–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∏ –≥–∏–±–∫–æ–π —Å–∏—Å—Ç–µ–º–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.

## üöÄ –ù–æ–≤–æ–≤–≤–µ–¥–µ–Ω–∏—è: –°–∏—Å—Ç–µ–º–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
- [–°–∏—Å—Ç–µ–º–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏](#—Å–∏—Å—Ç–µ–º–∞-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏)
- [–§—É–Ω–∫—Ü–∏–∏](#—Ñ—É–Ω–∫—Ü–∏–∏)
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –º–µ—Ç–æ–¥–∞–º](#–ø–æ–ª–Ω–∞—è-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è-–ø–æ-–º–µ—Ç–æ–¥–∞–º)
- [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏)
- [–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã](#–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ-–ø—Ä–∏–º–µ—Ä—ã)
- [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
- [–ú–∏–≥—Ä–∞—Ü–∏—è](#–º–∏–≥—Ä–∞—Ü–∏—è)

## üìã –°–∏—Å—Ç–µ–º–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã

- **–ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞**: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ YAML/JSON —Ñ–∞–π–ª—ã
- **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**: –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç env vars –Ω–∞–¥ —Ñ–∞–π–ª–∞–º–∏
- **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: API –∫–ª—é—á–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö
- **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –°—Ç–∞—Ä—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

### üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```
python/
‚îú‚îÄ‚îÄ config.yaml              # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ qdrant_config.py         # –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
‚îú‚îÄ‚îÄ qdrant_manager_with_config.py  # –ù–æ–≤—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ qdrant_manager.py        # –°—Ç–∞—Ä—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä (–æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)
‚îú‚îÄ‚îÄ test_config_system.py    # –ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îî‚îÄ‚îÄ USAGE.md                 # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
```

### üìù –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞

```yaml
# config.yaml
qdrant:
  host: "localhost"
  port: 6333
  api_key: "your-api-key-here"
  timeout: 30
  collections:
    default_threshold: 1
    batch_size: 100
```

### üîß –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∞–¥ —Ñ–∞–π–ª–æ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
export QDRANT_HOST="your-host.com"
export QDRANT_PORT="6333"
export QDRANT_API_KEY="your-api-key"
export QDRANT_TIMEOUT="60"
```

## üìã –§—É–Ω–∫—Ü–∏–∏

### üî• **–ì–ª–∞–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- **–ú–∞—Å—Å–æ–≤–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** `indexing_threshold` –¥–ª—è –≤—Å–µ—Ö –∫–æ–ª–ª–µ–∫—Ü–∏–π
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–∞** –≤—Å–µ—Ö –∫–æ–ª–ª–µ–∫—Ü–∏–π
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π** –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–ª–ª–µ–∫—Ü–∏–π
- **–ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞** —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ** API –∫–ª—é—á–µ–π

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –° –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```python
from qdrant_manager_with_config import QdrantManager

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ config.yaml
manager = QdrantManager()

# –ò–ª–∏ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –ø—É—Ç–∏ –∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
manager = QdrantManager(config_path="path/to/config.yaml")

# üî• –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –í–°–ï –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π!
results = manager.fix_all_collections()

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–∞ –≤—Å–µ—Ö –∫–æ–ª–ª–µ–∫—Ü–∏–π
status = manager.get_collections_status()
for name, info in status.items():
    if 'error' not in info:
        print(f"{name}: {info['points']} —Ç–æ—á–µ–∫, –ø–æ—Ä–æ–≥: {info['threshold']}")
```

### –ë–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)

```python
from qdrant_manager import QdrantConfigManager

# –°—Ç–∞—Ä—ã–π —Å–ø–æ—Å–æ–± - –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
manager = QdrantConfigManager(QDRANT_URL, API_KEY)
results = manager.fix_all_collections()
```

## üìñ –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –º–µ—Ç–æ–¥–∞–º

### **1. –ú–∞—Å—Å–æ–≤–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏–π**

```python
def fix_all_collections(new_threshold: int = 1) -> Dict[str, bool]
```

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ò—Å–ø—Ä–∞–≤–ª—è–µ—Ç `indexing_threshold` –¥–ª—è –≤—Å–µ—Ö –∫–æ–ª–ª–µ–∫—Ü–∏–π

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `new_threshold` (int): –ù–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ—Ä–æ–≥–∞ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1)

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```python
{
    'collection_1': True,   # –£—Å–ø–µ—à–Ω–æ
    'collection_2': False,  # –û—à–∏–±–∫–∞
    # ...
}
```

**–ü—Ä–∏–º–µ—Ä—ã:**
```python
# –° —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º –ø–æ—Ä–æ–≥–æ–º (1)
results = manager.fix_all_collections()

# –° –∫–∞—Å—Ç–æ–º–Ω—ã–º –ø–æ—Ä–æ–≥–æ–º
results = manager.fix_all_collections(new_threshold=10)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
successful = sum(1 for success in results.values() if success)
print(f"–£—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: {successful}/{len(results)}")
```

### **2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–∞ –∫–æ–ª–ª–µ–∫—Ü–∏–π**

```python
def get_collections_status() -> Dict[str, Dict]
```

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª—É—á–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—Å–µ—Ö –∫–æ–ª–ª–µ–∫—Ü–∏—è—Ö

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```python
{
    'collection_name': {
        'points': 1000,           # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫
        'indexed': 800,           # –ü—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤
        'threshold': 1            # –¢–µ–∫—É—â–∏–π –ø–æ—Ä–æ–≥
    },
    # –∏–ª–∏ –¥–ª—è –æ—à–∏–±–æ–∫:
    'broken_collection': {
        'error': '–û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏'
    }
}
```

**–ü—Ä–∏–º–µ—Ä—ã:**
```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞
status = manager.get_collections_status()

# –ê–Ω–∞–ª–∏–∑ —Å—Ç–∞—Ç—É—Å–∞
for name, info in status.items():
    if 'error' in info:
        print(f"‚ùå {name}: –û—à–∏–±–∫–∞ - {info['error']}")
    else:
        indexed_ratio = info['indexed'] / info['points'] * 100
        print(f"‚úÖ {name}: {info['points']} —Ç–æ—á–µ–∫, {info['indexed']} –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–æ ({indexed_ratio:.1f}%)")

# –ü–æ–∏—Å–∫ –∫–æ–ª–ª–µ–∫—Ü–∏–π —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º –ø–æ—Ä–æ–≥–æ–º
high_threshold = [name for name, info in status.items() 
                 if info.get('threshold', 0) > 1]
print(f"–ö–æ–ª–ª–µ–∫—Ü–∏–∏ —Å –≤—ã—Å–æ–∫–∏–º –ø–æ—Ä–æ–≥–æ–º: {high_threshold}")
```

### **3. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ –∫–æ–ª–ª–µ–∫—Ü–∏—è–º–∏**

```python
def fix_indexing_threshold(collection_name: str, new_threshold: int = 1) -> bool
```

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ò—Å–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ—Ä–æ–≥ –¥–ª—è –æ–¥–Ω–æ–π –∫–æ–ª–ª–µ–∫—Ü–∏–∏

```python
# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–¥–Ω–æ–π –∫–æ–ª–ª–µ–∫—Ü–∏–∏
success = manager.fix_indexing_threshold("my_collection", new_threshold=5)
if success:
    print("–ö–æ–ª–ª–µ–∫—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∞")
```

### **4. –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–æ–ª–ª–µ–∫—Ü–∏–∏**

```python
def get_collection_info(collection_name: str) -> Dict[str, Any]
```

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª—É—á–∞–µ—Ç –ø–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–ª–ª–µ–∫—Ü–∏–∏

**–ü—Ä–∏–º–µ—Ä:**
```python
info = manager.get_collection_info("my_collection")
config = info['result']['config']
print(f"–ü–æ—Ä–æ–≥ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏: {config['optimizer_config']['indexing_threshold']}")
```

## üõ†Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### üìù –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞

1. **–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `config.yaml`** –≤ –ø–∞–ø–∫–µ `python/`:

```yaml
# config.yaml
qdrant:
  host: "localhost"
  port: 6333
  api_key: "your-api-key-here"
  timeout: 30
  collections:
    default_threshold: 1
    batch_size: 100
```

2. **–ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ `config.json`**:

```json
{
  "qdrant": {
    "host": "localhost",
    "port": 6333,
    "api_key": "your-api-key-here",
    "timeout": 30,
    "collections": {
      "default_threshold": 1,
      "batch_size": 100
    }
  }
}
```

### üîß –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–º–µ—é—Ç **–≤—ã—Å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç** –Ω–∞–¥ —Ñ–∞–π–ª–æ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

```bash
# Linux/macOS
export QDRANT_HOST="your-host.com"
export QDRANT_PORT="6333"
export QDRANT_API_KEY="your-api-key"
export QDRANT_TIMEOUT="60"

# Windows (cmd)
set QDRANT_HOST=your-host.com
set QDRANT_PORT=6333
set QDRANT_API_KEY=your-api-key
set QDRANT_TIMEOUT=60

# Windows (PowerShell)
$env:QDRANT_HOST="your-host.com"
$env:QDRANT_PORT="6333"
$env:QDRANT_API_KEY="your-api-key"
$env:QDRANT_TIMEOUT="60"
```

### üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ API –∫–ª—é—á–µ–π

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Å–ø–æ—Å–æ–±—ã:**

1. **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):
```bash
export QDRANT_API_KEY="your-secret-api-key"
```

2. **–û—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**:
```yaml
# config.yaml
qdrant:
  host: "localhost"
  port: 6333
  api_key: "your-api-key-here"
  timeout: 30
```

3. **–°–µ–∫—Ä–µ—Ç—ã —Å–∏—Å—Ç–µ–º—ã** (–¥–ª—è production):
```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–µ–∫—Ä–µ—Ç–æ–≤
export QDRANT_API_KEY=$(cat /run/secrets/qdrant_api_key)
```

## üìä –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã

### **–ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª: –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ ‚Üí –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞**

```python
from qdrant_manager_with_config import QdrantManager

def optimize_all_collections():
    # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
    manager = QdrantManager()
    
    print("üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è...")
    before_status = manager.get_collections_status()
    
    # –ù–∞–π–¥–µ–º –∫–æ–ª–ª–µ–∫—Ü–∏–∏ —Å –≤—ã—Å–æ–∫–∏–º –ø–æ—Ä–æ–≥–æ–º
    needs_fix = []
    for name, info in before_status.items():
        if info.get('threshold', 1) > 1:
            needs_fix.append(name)
    
    if needs_fix:
        print(f"üîß –ù–∞–π–¥–µ–Ω–æ {len(needs_fix)} –∫–æ–ª–ª–µ–∫—Ü–∏–π –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è")
        results = manager.fix_all_collections()
        
        print("\nüìä –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç...")
        after_status = manager.get_collections_status()
        
        for name in needs_fix:
            if after_status[name].get('threshold', 1) == 1:
                print(f"‚úÖ {name} - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞")
            else:
                print(f"‚ùå {name} - –æ—à–∏–±–∫–∞")
    else:
        print("‚úÖ –í—Å–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ —É–∂–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã")

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
optimize_all_collections()
```

### **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞**

```python
def generate_report(manager):
    status = manager.get_collections_status()
    
    total_points = 0
    total_indexed = 0
    collections_with_errors = []
    
    print("üìä –û–¢–ß–ï–¢ –ü–û –ö–û–õ–õ–ï–ö–¶–ò–Ø–ú QDRANT")
    print("=" * 50)
    
    for name, info in status.items():
        if 'error' in info:
            collections_with_errors.append((name, info['error']))
            continue
            
        points = info['points']
        indexed = info['indexed']
        threshold = info['threshold']
        
        total_points += points
        total_indexed += indexed
        
        indexed_percent = (indexed / points * 100) if points > 0 else 0
        
        status_icon = "‚ö†Ô∏è" if threshold > 1 else "‚úÖ"
        print(f"{status_icon} {name:20} | {points:6} —Ç–æ—á–µ–∫ | {indexed:6} –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–æ | {indexed_percent:5.1f}% | –ø–æ—Ä–æ–≥: {threshold}")
    
    print("=" * 50)
    overall_percent = (total_indexed / total_points * 100) if total_points > 0 else 0
    print(f"üìà –ò–¢–û–ì–û: {total_points} —Ç–æ—á–µ–∫, {total_indexed} –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–æ ({overall_percent:.1f}%)")
    
    if collections_with_errors:
        print(f"\nüö® –ö–æ–ª–ª–µ–∫—Ü–∏–∏ —Å –æ—à–∏–±–∫–∞–º–∏: {len(collections_with_errors)}")
        for name, error in collections_with_errors:
            print(f"  ‚ùå {name}: {error}")

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
manager = QdrantManager()
generate_report(manager)
```

### **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å –∫–∞—Å—Ç–æ–º–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π**

```python
from qdrant_manager_with_config import QdrantManager

# –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
manager = QdrantManager(config_path="production_config.yaml")

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è
import os
os.environ['QDRANT_HOST'] = 'production-host.com'
os.environ['QDRANT_API_KEY'] = 'production-key'

manager = QdrantManager()  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç env vars
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
pip install -r test_requirements.txt

# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
python test_config_system.py

# –ò–ª–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º pytest
pytest test_config_system.py -v
```

### –¢–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç:

- ‚úÖ –ë–∞–∑–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞–¥ —Ñ–∞–π–ª–æ–º
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—é –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –≤—Å–µ—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤
- ‚úÖ –û–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ —Å—Ç–∞—Ä—ã–º–∏ –∏–º–ø–æ—Ä—Ç–∞–º–∏
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–π

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è

### –°—Ç–∞—Ä—ã–π –∫–æ–¥ ‚Üí –ù–æ–≤—ã–π –∫–æ–¥

**–ë—ã–ª–æ (—Å—Ç–∞—Ä—ã–π —Å–ø–æ—Å–æ–±):**
```python
from qdrant_manager import QdrantConfigManager

QDRANT_URL = "https://your-cluster.qdrant.io:6333"
API_KEY = "your_api_key_here"

manager = QdrantConfigManager(QDRANT_URL, API_KEY)
results = manager.fix_all_collections()
```

**–°—Ç–∞–ª–æ (–Ω–æ–≤—ã–π —Å–ø–æ—Å–æ–±):**
```python
from qdrant_manager_with_config import QdrantManager

# –°–æ–∑–¥–∞–µ–º config.yaml
# qdrant:
#   host: "your-cluster.qdrant.io"
#   port: 6333
#   api_key: "your_api_key_here"
#   timeout: 30

manager = QdrantManager()  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥
results = manager.fix_all_collections()
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –º–∏–≥—Ä–∞—Ü–∏–∏:

1. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: API –∫–ª—é—á–∏ –Ω–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –∫–æ–¥–µ
2. **–ì–∏–±–∫–æ—Å—Ç—å**: –õ–µ–≥–∫–∞—è —Å–º–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞
3. **–û–∫—Ä—É–∂–µ–Ω–∏—è**: –†–∞–∑–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è dev/staging/prod
4. **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
5. **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –°—Ç–∞—Ä—ã–π –∫–æ–¥ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **API –∫–ª—é—á** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è
2. **–ü–æ—Ä–æ–≥ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é** - —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ 1 –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏
3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - –≤—Å–µ –º–µ—Ç–æ–¥—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏—è
4. **–°—Ç–∞—Ç—É—Å –∫–æ–¥—ã** - –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
5. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** - –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–º–µ—é—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∞–¥ —Ñ–∞–π–ª–∞–º–∏

## üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

–ú–µ—Ç–æ–¥ `get_collections_status()` **–¥–æ–±–∞–≤–ª–µ–Ω** –∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤—Å–µ—Ö –∫–æ–ª–ª–µ–∫—Ü–∏–π!

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ [USAGE.md](USAGE.md) –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ [test_config_system.py](test_config_system.py) –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–∏—Å—Ç–µ–º—ã
- –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ [qdrant_config_analysis.md](qdrant_config_analysis.md) –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å–∏—Å—Ç–µ–º—ã